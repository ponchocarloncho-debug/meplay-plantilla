<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - My Video Site</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- ========== PASTE YOUR ADS SCRIPT HERE ========== -->
    <script>
        // Paste your AdSense, PropellerAds, or other ad network script here
    </script>
    <!-- ========== END ADS SCRIPT ========== -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
            min-height: 100vh;
        }

        .navbar {
            background-color: #0f0f0f;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            gap: 20px;
        }

        .navbar-left { display: flex; justify-content: flex-start; }
        .navbar-center { display: flex; justify-content: center; }
        .navbar-right { display: flex; justify-content: flex-end; }

        .logo {
            height: 60px;
            width: auto;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .logo:hover { transform: scale(1.05); }

        .nav-btn {
            background-color: #2a2a2a;
            color: #ffffff;
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
        }

        .nav-btn:hover { 
            background-color: #e50914;
            transform: translateY(-2px);
        }
        
        /* Favorites button - ensure red hover works */
        .nav-btn#favoritesBtn:hover {
            background-color: #e50914 !important;
        }

        /* Favorites badge */
        .favorites-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e50914;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 11px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #0f0f0f;
        }

        /* Reload button */
        .reload-btn {
            background-color: #e50914;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .reload-btn:hover {
            background-color: #ff0a16;
        }

        .search-bar {
            background-color: #0f0f0f;
            padding: 15px 30px;
            border-bottom: 1px solid #2a2a2a;
        }

        .search-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .search-box {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: 12px 45px 12px 20px;
            background-color: #2a2a2a;
            border: 2px solid #3a3a3a;
            border-radius: 8px;
            color: #ffffff;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        .search-input:focus { border-color: #e50914; }
        .search-input::placeholder { color: #888; }
        
        .search-clear {
            position: absolute;
            right: 140px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #888;
            font-size: 20px;
            cursor: pointer;
            padding: 0 10px;
            display: none;
        }
        
        .search-clear:hover { color: #e50914; }
        .search-clear.show { display: block; }

        .search-btn {
            padding: 12px 30px;
            background-color: #e50914;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .search-btn:hover { background-color: #ff0a16; }

        .search-results {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 20px auto 0;
            background-color: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            display: none;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .search-results.active { display: block; }

        .search-result-item {
            padding: 12px 20px;
            border-bottom: 1px solid #3a3a3a;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-result-item:hover { background-color: #333; }
        .search-result-item:last-child { border-bottom: none; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        @media (max-width: 768px) {
            /* NAVBAR RESPONSIVE */
            .navbar {
                padding: 10px 20px;
            }
            
            .navbar-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .navbar-center {
                order: 1;
                width: 100%;
                text-align: center;
            }
            
            .navbar-left, .navbar-right {
                order: 2;
            }
            
            .navbar-left {
                margin-right: 5px;
            }
            
            .navbar-right {
                margin-left: 5px;
            }
            
            /* SEARCH RESPONSIVE */
            .search-bar {
                padding: 10px 15px;
            }
            
            .search-box {
                flex-direction: column;
                gap: 8px;
            }
            
            .search-input {
                width: 100%;
                padding: 10px 40px 10px 15px;
            }
            
            .search-clear {
                right: 10px;
            }
            
            .search-btn {
                width: 100%;
                padding: 10px;
            }
            
            .search-results {
                right: 0;
                left: 0;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-left">
                <a href="index.html" class="nav-btn">Home</a>
            </div>
            <div class="navbar-center">
                <a href="index.html">
                    <img src="logo.png" alt="Logo" class="logo" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22150%22 height=%2240%22%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2224%22 fill=%22%23e50914%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 font-family=%22Arial%22%3EMY SITE%3C/text%3E%3C/svg%3E'">
                </a>
            </div>
            <div class="navbar-right">
                <a href="favorites.html" class="nav-btn" style="position: relative;" id="favoritesBtn">
                    Favorites
                    <span class="favorites-badge" id="favoritesCount" style="display: none;">0</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="search-bar">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="Search by title, description or tags...">
                <button class="search-clear" id="searchClear" onclick="clearSearch()">‚úï</button>
                <button class="search-btn" onclick="performSearch()">Search</button>
            </div>
        </div>
        <div class="search-results" id="searchResults"></div>
    </div>

    <div class="container">
        <div class="video-section" id="randomSection">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2 style="margin: 0; font-size: 22px;">üé≤ Random Videos</h2>
                <button onclick="location.reload()" class="reload-btn">üîÑ Reload</button>
            </div>
            <div class="video-grid" id="randomVideos"></div>
        </div>

        <div class="video-section" id="recentsSection">
            <h2 style="font-size: 20px;">üïí Recent Videos</h2>
            <div class="video-grid" id="recentVideos"></div>
        </div>
    </div>

    <script>
        let searchTimeout;
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');

        // Toast notification system
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${type === 'success' ? '‚≠ê' : '‚úï'}</div>
                <div class="toast-message">${message}</div>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Override favorite functions to show toasts (wait for widget to load)
        function setupToasts() {
            if (typeof window.handleFavoriteClick !== 'undefined') {
                const originalHandleFavoriteClick = window.handleFavoriteClick;
                window.handleFavoriteClick = function(event, videoId) {
                    const wasFavorite = window.getFavorites && window.getFavorites().includes(videoId);
                    
                    // Get video name
                    const video = window.videosData ? window.videosData.find(v => v.id === videoId) : null;
                    let videoName = video ? video.title : 'Video';
                    
                    // Truncate if too long
                    if (videoName.length > 40) {
                        videoName = videoName.substring(0, 40) + '...';
                    }
                    
                    originalHandleFavoriteClick(event, videoId);
                    
                    if (!wasFavorite) {
                        showToast(`"${videoName}" added to favorites!`, 'success');
                    } else {
                        showToast(`"${videoName}" removed`, 'remove');
                    }
                    updateFavoritesCounter();
                };
                console.log('‚úì Toast notifications enabled');
            } else {
                setTimeout(setupToasts, 100);
            }
        }
        
        setupToasts();

        // Update favorites counter
        function updateFavoritesCounter() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const badge = document.getElementById('favoritesCount');
            if (favorites.length > 0) {
                badge.textContent = favorites.length;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        updateFavoritesCounter();
        setInterval(updateFavoritesCounter, 500);

        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            const query = this.value.trim();
            const clearBtn = document.getElementById('searchClear');
            
            // Show/hide clear button
            if (query.length > 0) {
                clearBtn.classList.add('show');
            } else {
                clearBtn.classList.remove('show');
            }
            
            if (query.length > 2) {
                searchTimeout = setTimeout(() => showSearchResults(query), 300);
            } else {
                searchResults.classList.remove('active');
            }
        });

        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') performSearch();
        });

        function performSearch() {
            const query = searchInput.value.trim();
            if (query.length > 0) showSearchResults(query);
        }
        
        function clearSearch() {
            searchInput.value = '';
            searchResults.classList.remove('active');
            document.getElementById('searchClear').classList.remove('show');
        }

        function showSearchResults(query) {
            const allVideos = window.videosData;
            
            if (!allVideos || allVideos.length === 0) {
                searchResults.innerHTML = '<div style="padding: 60px 20px; text-align: center; color: #888;">Loading videos... Please wait.</div>';
                searchResults.classList.add('active');
                return;
            }
            
            const lowerQuery = query.toLowerCase();
            
            // Count by search type
            let titleMatches = 0;
            let descMatches = 0;
            let tagMatches = 0;
            
            const results = allVideos.filter(video => {
                let matched = false;
                if (video.title.toLowerCase().includes(lowerQuery)) {
                    titleMatches++;
                    matched = true;
                }
                if (video.description && video.description.toLowerCase().includes(lowerQuery)) {
                    descMatches++;
                    if (!matched) matched = true;
                }
                if (video.tags && video.tags.some(tag => tag.toLowerCase().includes(lowerQuery))) {
                    tagMatches++;
                    if (!matched) matched = true;
                }
                return matched;
            });
            
            if (results && results.length > 0) {
                let html = `<div style="padding: 20px; background: #1a1a1a; border-bottom: 2px solid #e50914;">
                    <div style="color: #e50914; font-weight: bold; font-size: 20px; margin-bottom: 10px;">
                        üîç Found ${results.length} result${results.length !== 1 ? 's' : ''}
                    </div>
                    <div style="color: #888; font-size: 14px;">
                        ${titleMatches > 0 ? `üìù ${titleMatches} in titles` : ''}
                        ${descMatches > 0 ? (titleMatches > 0 ? ' ‚Ä¢ ' : '') + `üìÑ ${descMatches} in descriptions` : ''}
                        ${tagMatches > 0 ? ((titleMatches > 0 || descMatches > 0) ? ' ‚Ä¢ ' : '') + `üè∑Ô∏è ${tagMatches} in tags` : ''}
                    </div>
                </div>`;
                
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; padding: 30px;">';
                
                html += results.slice(0, 16).map(video => {
                    const randomImage = video.images && video.images.length > 0 
                        ? video.images[Math.floor(Math.random() * video.images.length)]
                        : video.thumbnail;
                    
                    return `<div onclick="window.location.href='${video.url}'" style="cursor: pointer; background: #1a1a1a; border-radius: 8px; overflow: hidden; transition: all 0.3s; border: 2px solid transparent;">
                        <img src="${randomImage}" style="width: 100%; aspect-ratio: 16/9; object-fit: cover;">
                        <div style="padding: 15px;">
                            <strong style="display: block; margin-bottom: 8px; font-size: 15px; line-height: 1.4;">${video.title}</strong>
                        </div>
                    </div>`;
                }).join('');
                
                html += '</div>';
                
                if (results.length > 16) {
                    html += '<div style="padding: 20px; text-align: center; color: #888; font-size: 14px; border-top: 1px solid #3a3a3a;">+ ' + (results.length - 16) + ' more results</div>';
                }
                
                searchResults.innerHTML = html;
            } else {
                searchResults.innerHTML = '<div style="padding: 60px 20px; text-align: center; color: #888; font-size: 18px;">No results found for "' + query + '"</div>';
            }
            searchResults.classList.add('active');
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-box') && !e.target.closest('.search-results')) {
                searchResults.classList.remove('active');
            }
        });
        
        // Add toast styles
        const toastStyles = `
            <style>
                .toast {
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
                    color: white;
                    padding: 16px 24px;
                    border-radius: 12px;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
                    display: flex;
                    align-items: center;
                    gap: 12px;
                    z-index: 10000;
                    transform: translateX(400px);
                    transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                    border: 2px solid #3a3a3a;
                }
                
                .toast.show {
                    transform: translateX(0);
                }
                
                .toast-success {
                    border-left: 4px solid #4CAF50;
                }
                
                .toast-remove {
                    border-left: 4px solid #e50914;
                }
                
                .toast-icon {
                    font-size: 24px;
                    flex-shrink: 0;
                }
                
                .toast-message {
                    font-weight: 600;
                    font-size: 15px;
                }
                
                @media (max-width: 768px) {
                    .toast {
                        right: 10px;
                        left: 10px;
                        transform: translateY(-100px);
                    }
                    
                    .toast.show {
                        transform: translateY(0);
                    }
                }
            </style>
        `;
        document.head.insertAdjacentHTML('beforeend', toastStyles);
        
        // Auto-search if query parameter exists (from tag clicks)
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        if (searchQuery) {
            searchInput.value = searchQuery;
            showSearchResults(searchQuery);
        }
    </script>

    <script src="widget.js"></script>
</body>
</html>
